syms th1 th2 w1 w2 u

M = [ 0.0000015107182090000000001719232534114*cos(2.0*th2) - 0.0000015107182090000000001719232534114*cos(2.0*th1) + 0.000013759501475700000001565863338993*cos(th2) + 0.0000015107182090000000001719232534114*cos(2.0*th1)*cos(2.0*th2) - 0.0000020957862964500000002385053654574*sin(2.0*th1)*sin(2.0*th2) - 0.0000038411574817000000004371326745023*sin(2.0*th1)*sin(th2) + 0.000021762803254440000361458506562568, 0.0000049591719970000000005643653322451*cos(th2) + 0.0000020957862964500000002385053654574*cos(2.0*th1)*cos(2.0*th2) - 0.0000015107182090000000001719232534114*sin(2.0*th1)*sin(2.0*th2) + 0.0000019205787408500000002185663372511*cos(2.0*th1)*cos(th2) + 0.0000055298495890000000002084643859444;
      0.0000049591719970000000005643653322451*cos(th2) + 0.0000020957862964500000002385053654574*cos(2.0*th1)*cos(2.0*th2) - 0.0000015107182090000000001719232534114*sin(2.0*th1)*sin(2.0*th2) + 0.0000019205787408500000002185663372511*cos(2.0*th1)*cos(th2) + 2.0e-39*sin(2.0*th1)*sin(th2) + 0.0000055298495890000000002084643859444,     0.0000015107182090000000001719232534114*cos(2.0*th1) - 0.0000015107182090000000001719232534114*cos(2.0*th2) + 0.0000015107182090000000001719232534114*cos(2.0*th1)*cos(2.0*th2) - 0.0000020957862964500000002385053654574*sin(2.0*th1)*sin(2.0*th2) + 0.0000061149176764500000002750464979905];

V = [ 0.0000057617362225500000006556990117535*w1.^2*sin(2.0*th1 - 1.0*th2) - 0.0000057617362225500000006556990117535*w1.^2*sin(2.0*th1 + th2) - 0.0000054097567581750000006156429283033*w1.^2*sin(2*th1 + 2*th2) + 0.0000018032522527250000002052143094344*w2.^2*sin(2*th1 + 2*th2) + 0.0000045321546270000000005157697602343*w1.^2*sin(2.0*th1) + 0.0000015107182090000000001719232534114*w2.^2*sin(2.0*th1) + 0.00000087760213117500000009987316806903*w1.^2*sin(2*th1 - 2.0*th2) - 0.00000029253404372500000003329105602301*w2.^2*sin(2*th1 - 2.0*th2) - 0.0000019205787408500000002185663372511*w1*w2*sin(2.0*th1 - 1.0*th2) - 0.0000019205787408500000002185663372511*w1*w2*sin(2.0*th1 + th2) - 0.0000036065045054500000004104286188689*w1*w2*sin(2*th1 + 2*th2) - 0.00000058506808745000000006658211204602*w1*w2*sin(2*th1 - 2.0*th2);
      0.0000068797507378500000007829316694963*w1.^2*sin(th2) + 0.00000096028937042500000010928316862557*w1.^2*sin(2.0*th1 - 1.0*th2) + 0.00000096028937042500000010928316862557*w1.^2*sin(2.0*th1 + th2) + 0.0000018032522527250000002052143094344*w1.^2*sin(2*th1 + 2*th2) - 0.0000054097567581750000006156429283033*w2.^2*sin(2*th1 + 2*th2) + 0.0000015107182090000000001719232534114*w1.^2*sin(2.0*th2) + 0.0000045321546270000000005157697602343*w2.^2*sin(2.0*th2) + 0.00000029253404372500000003329105602301*w1.^2*sin(2*th1 - 2.0*th2) - 0.00000087760213117500000009987316806903*w2.^2*sin(2*th1 - 2.0*th2) - 0.0000049591719970000000005643653322451*w1*w2*sin(th2) + 0.00000096028937042500000010928316862557*w1*w2*sin(2.0*th1 - 1.0*th2) - 0.00000096028937042500000010928316862557*w1*w2*sin(2.0*th1 + th2) - 0.0000036065045054500000004104286188689*w1*w2*sin(2*th1 + 2*th2) + 0.00000058506808745000000006658211204602*w1*w2*sin(2*th1 - 2.0*th2)];

G = [ 0.0015690378690000000733856255763499*sin(th1)*sin(th2) - 0.0015690378690000000733856255763499*cos(th1)*cos(th2) - 0.0035166983166000003780543581299867*cos(th1);
                                                0.0015690378690000000733856255763499*sin(th1)*sin(th2) - 0.0015690378690000000733856255763499*cos(th1)*cos(th2)];

Tau_Stiffness_Relaxed_coeffs = [0, -1.4724e-14, 7.2021e-11, - 1.5778e-7, 1.0758e-4, 0.14548, 0, 0, 0, 0, 0, 0;
                                0, 0, 0, 0, 0, 0, 3.6689e-9, -6.6466e-7, 4.3944e-5, -1.267e-3, 1.3425e-2, 3.056e-2];
Tau_Stiffness_Extended_coeffs = [2.4553e-9, -7.4367e-7, 8.1609e-5, -3.9209e-3, 6.6136e-2, 0.34106, 0, 0, 0, 0, 0, 0;
                                 0, 0, 0, 0, 0, 0, -1.565e-9, 3.4856e-7, -2.1952e-5, 2.9395e-4, 3.0018e-3, 0.23896];             
func_q = [(th1*(180/pi))^5, (th1*(180/pi))^4, (th1*(180/pi))^3, (th1*(180/pi))^2, (th1*(180/pi)), 1, (th2*(180/pi))^5, (th2*(180/pi))^4, (th2*(180/pi))^3, (th2*(180/pi))^2, (th2*(180/pi)), 1];
      
Tau_Stiffness_Relaxed = Tau_Stiffness_Relaxed_coeffs*func_q.';
                                            
dx = sym(zeros(4,1));
dx(1,1) = w1;
dx(2,1) = w2;
dx(3:4,1) = vpa(simplify(expand(M\(u - V - G - Tau_Stiffness_Relaxed))),3);

vpa(dx,3)